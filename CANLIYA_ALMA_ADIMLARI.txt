# ğŸš€ BULUTÄ°STAN DJANGO PROJESÄ° - CANLIYA ALMA ADIMLARI
# Tarih: Åimdi
# Sunucu: 10.40.39.24 (ubuntu)

## ğŸ“‹ Ã–N HAZIRLIK (TAMAMLANDI)

### âœ… OluÅŸturulan Dosyalar:
1. requirements.txt - Python baÄŸÄ±mlÄ±lÄ±klarÄ±
2. bulutistan/settings_production.py - Production ayarlarÄ±
3. gunicorn.conf.py - Gunicorn konfigÃ¼rasyonu
4. deploy.sh - Otomatik deployment script'i
5. env_example.txt - Environment deÄŸiÅŸkenleri
6. README.md - DetaylÄ± kÄ±lavuz
7. sunucu_baglanti_kontrol.md - BaÄŸlantÄ± sorunlarÄ± Ã§Ã¶zÃ¼mÃ¼
8. bulutistan/templates/index.html - Ana sayfa template'i
9. bulutistan/urls.py - URL yapÄ±landÄ±rmasÄ± gÃ¼ncellendi

### âœ… YapÄ±lan DeÄŸiÅŸiklikler:
- Django settings production iÃ§in hazÄ±rlandÄ±
- PostgreSQL veritabanÄ± entegrasyonu
- Gunicorn + Nginx yapÄ±landÄ±rmasÄ±
- TÃ¼rkÃ§e dil desteÄŸi (tr-tr)
- Ä°stanbul saat dilimi
- GÃ¼venlik ayarlarÄ±
- Logging yapÄ±landÄ±rmasÄ±

## ğŸ”Œ ADIM 1: SUNUCU BAÄLANTISI

### 1.1 VMware vSphere Client Ãœzerinden Konsol EriÅŸimi:
```
1. vSphere Client'a giriÅŸ yapÄ±n
2. Sunucuya (ubuntu) saÄŸ tÄ±klayÄ±n
3. "Open Console" seÃ§in
4. Konsol Ã¼zerinden terminal eriÅŸimi saÄŸlayÄ±n
```

### 1.2 SSH Servisini EtkinleÅŸtirme:
```bash
# SSH servisini kontrol et
sudo systemctl status ssh

# SSH servisini etkinleÅŸtir
sudo systemctl enable ssh
sudo systemctl start ssh

# SSH port'unu aÃ§
sudo ufw allow ssh
sudo ufw allow 22

# SSH konfigÃ¼rasyonÄ±nÄ± kontrol et
sudo nano /etc/ssh/sshd_config

# Ã–nemli ayarlar:
Port 22
ListenAddress 0.0.0.0
PermitRootLogin no
PasswordAuthentication yes
PubkeyAuthentication yes

# SSH servisini yeniden baÅŸlat
sudo systemctl restart ssh
```

### 1.3 AÄŸ YapÄ±landÄ±rmasÄ± KontrolÃ¼:
```bash
# IP adresini kontrol et
ip addr show

# Gateway'i kontrol et
ip route show

# DNS ayarlarÄ±nÄ± kontrol et
cat /etc/resolv.conf

# Network servislerini yeniden baÅŸlat
sudo systemctl restart networking
sudo systemctl restart systemd-networkd
```

### 1.4 GÃ¼venlik DuvarÄ± AyarlarÄ±:
```bash
# UFW durumunu kontrol et
sudo ufw status

# SSH iÃ§in kural ekle
sudo ufw allow ssh
sudo ufw allow 22/tcp

# GÃ¼venlik duvarÄ±nÄ± etkinleÅŸtir
sudo ufw enable
```

## ğŸš€ ADIM 2: DJANGO PROJESÄ°NÄ° SUNUCUYA KOPYALAMA

### 2.1 Yerel Bilgisayardan Proje Kopyalama:
```bash
# Windows PowerShell'de:
scp -r bulutistan/ ubuntu@10.40.39.24:/var/www/

# EÄŸer SSH anahtarÄ± yoksa:
scp -r bulutistan/ ubuntu@10.40.39.24:/var/www/
# Åifre sorulacak
```

### 2.2 Alternatif: Git ile Kopyalama:
```bash
# Sunucuda:
sudo mkdir -p /var/www/bulutistan
sudo chown $USER:$USER /var/www/bulutistan
cd /var/www/bulutistan

# Git repository'den clone:
git clone <repository-url> .
# veya
# DosyalarÄ± manuel olarak kopyala
```

## ğŸ—„ï¸ ADIM 3: POSTGRESQL KURULUMU VE YAPILANDIRMASI

### 3.1 PostgreSQL Kurulumu:
```bash
# Sistem gÃ¼ncellemeleri
sudo apt update && sudo apt upgrade -y

# PostgreSQL kurulumu
sudo apt install -y postgresql postgresql-contrib

# PostgreSQL servisini baÅŸlat
sudo systemctl start postgresql
sudo systemctl enable postgresql

# Servis durumunu kontrol et
sudo systemctl status postgresql
```

### 3.2 VeritabanÄ± ve KullanÄ±cÄ± OluÅŸturma:
```bash
# PostgreSQL'e postgres kullanÄ±cÄ±sÄ± olarak baÄŸlan
sudo -u postgres psql

# VeritabanÄ± oluÅŸtur
CREATE DATABASE bulutistan_db;

# KullanÄ±cÄ± oluÅŸtur
CREATE USER bulutistan_user WITH PASSWORD 'your_secure_password';

# Yetkileri ver
GRANT ALL PRIVILEGES ON DATABASE bulutistan_db TO bulutistan_user;
ALTER USER bulutistan_user CREATEDB;

# PostgreSQL'den Ã§Ä±k
\q
```

### 3.3 VeritabanÄ± BaÄŸlantÄ± Testi:
```bash
# Yeni kullanÄ±cÄ± ile baÄŸlantÄ± testi
psql -h localhost -U bulutistan_user -d bulutistan_db
# Åifre sorulacak

# VeritabanlarÄ±nÄ± listele
\l

# Ã‡Ä±k
\q
```

## ğŸ ADIM 4: PYTHON ORTAMI VE DJANGO KURULUMU

### 4.1 Python ve Gerekli Paketlerin Kurulumu:
```bash
# Python3 ve pip kurulumu
sudo apt install -y python3 python3-pip python3-venv

# Python versiyonunu kontrol et
python3 --version
pip3 --version

# Proje dizinine git
cd /var/www/bulutistan

# Virtual environment oluÅŸtur
python3 -m venv venv

# Virtual environment'Ä± aktifleÅŸtir
source venv/bin/activate

# Pip'i gÃ¼ncelle
pip install --upgrade pip

# Gerekli paketleri yÃ¼kle
pip install -r requirements.txt
```

### 4.2 Environment DeÄŸiÅŸkenleri:
```bash
# .env dosyasÄ± oluÅŸtur
cat > .env << EOF
SECRET_KEY=$(python3 -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())')
DEBUG=False
ALLOWED_HOSTS=localhost,127.0.0.1,10.40.39.24
DATABASE_URL=postgresql://bulutistan_user:your_secure_password@localhost:5432/bulutistan_db
EOF

# .env dosyasÄ±nÄ± kontrol et
cat .env
```

## âš™ï¸ ADIM 5: DJANGO YAPILANDIRMASI

### 5.1 Production Settings:
```bash
# Environment deÄŸiÅŸkenini ayarla
export DJANGO_SETTINGS_MODULE=bulutistan.settings_production

# Django ayarlarÄ±nÄ± test et
python manage.py check --deploy

# VeritabanÄ± migration'larÄ±nÄ± yap
python manage.py migrate

# Static dosyalarÄ± topla
python manage.py collectstatic --noinput

# Superuser oluÅŸtur
python manage.py createsuperuser
# KullanÄ±cÄ± adÄ±, email ve ÅŸifre girin
```

### 5.2 Django Test:
```bash
# Django development server ile test
python manage.py runserver 0.0.0.0:8000

# Yeni terminal'de test
curl http://localhost:8000
# veya tarayÄ±cÄ±da http://10.40.39.24:8000

# Ctrl+C ile durdur
```

## ğŸŒ ADIM 6: GUNICORN KURULUMU VE YAPILANDIRMASI

### 6.1 Gunicorn Test:
```bash
# Virtual environment aktif olmalÄ±
source venv/bin/activate

# Gunicorn ile test
gunicorn --config gunicorn.conf.py bulutistan.wsgi:application

# Yeni terminal'de test
curl http://localhost:8000
# Ctrl+C ile durdur
```

### 6.2 Systemd Service OluÅŸturma:
```bash
# Gunicorn systemd service dosyasÄ± oluÅŸtur
sudo tee /etc/systemd/system/bulutistan.service > /dev/null << EOF
[Unit]
Description=Bulutistan Django Application
After=network.target

[Service]
User=$USER
Group=$USER
WorkingDirectory=/var/www/bulutistan
Environment="PATH=/var/www/bulutistan/venv/bin"
Environment="DJANGO_SETTINGS_MODULE=bulutistan.settings_production"
ExecStart=/var/www/bulutistan/venv/bin/gunicorn --config gunicorn.conf.py bulutistan.wsgi:application
ExecReload=/bin/kill -s HUP \$MAINPID
Restart=always

[Install]
WantedBy=multi-user.target
EOF

# Service'i etkinleÅŸtir
sudo systemctl daemon-reload
sudo systemctl enable bulutistan
sudo systemctl start bulutistan

# Service durumunu kontrol et
sudo systemctl status bulutistan
```

## ğŸš€ ADIM 7: NGINX KURULUMU VE YAPILANDIRMASI

### 7.1 Nginx Kurulumu:
```bash
# Nginx kurulumu
sudo apt install -y nginx

# Nginx servisini baÅŸlat
sudo systemctl start nginx
sudo systemctl enable nginx

# Nginx durumunu kontrol et
sudo systemctl status nginx
```

### 7.2 Nginx KonfigÃ¼rasyonu:
```bash
# Nginx site konfigÃ¼rasyonu oluÅŸtur
sudo tee /etc/nginx/sites-available/bulutistan > /dev/null << EOF
server {
    listen 80;
    server_name 10.40.39.24;

    location = /favicon.ico { access_log off; log_not_found off; }
    
    location /static/ {
        root /var/www/bulutistan;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }

    location /media/ {
        root /var/www/bulutistan;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }

    location / {
        include proxy_params;
        proxy_pass http://unix:/var/www/bulutistan/bulutistan.sock;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
    }
}
EOF

# Site'Ä± etkinleÅŸtir
sudo ln -s /etc/nginx/sites-available/bulutistan /etc/nginx/sites-enabled

# Default site'Ä± devre dÄ±ÅŸÄ± bÄ±rak
sudo rm /etc/nginx/sites-enabled/default

# Nginx konfigÃ¼rasyonunu test et
sudo nginx -t

# Nginx'i yeniden baÅŸlat
sudo systemctl restart nginx
```

## ğŸ”§ ADIM 8: SOCKET DOSYASI YAPILANDIRMASI

### 8.1 Gunicorn Socket KonfigÃ¼rasyonu:
```bash
# Gunicorn.conf.py dosyasÄ±nÄ± gÃ¼ncelle
sudo nano /var/www/bulutistan/gunicorn.conf.py

# Socket binding ekle:
bind = "unix:/var/www/bulutistan/bulutistan.sock"

# Service'i yeniden baÅŸlat
sudo systemctl restart bulutistan

# Socket dosyasÄ±nÄ±n oluÅŸtuÄŸunu kontrol et
ls -la /var/www/bulutistan/bulutistan.sock
```

## ğŸ”’ ADIM 9: GÃœVENLÄ°K AYARLARI

### 9.1 Firewall YapÄ±landÄ±rmasÄ±:
```bash
# SSH iÃ§in kural
sudo ufw allow OpenSSH

# HTTP iÃ§in kural
sudo ufw allow 'Nginx Full'

# Firewall'u etkinleÅŸtir
sudo ufw --force enable

# Firewall durumunu kontrol et
sudo ufw status
```

### 9.2 Dosya Ä°zinleri:
```bash
# Proje dizini izinlerini ayarla
sudo chown -R $USER:$USER /var/www/bulutistan
sudo chmod -R 755 /var/www/bulutistan

# Log dizini oluÅŸtur
mkdir -p /var/www/bulutistan/logs
sudo chown -R $USER:$USER /var/www/bulutistan/logs
```

## ğŸ“Š ADIM 10: TEST VE DOÄRULAMA

### 10.1 Servis DurumlarÄ±:
```bash
# TÃ¼m servislerin durumunu kontrol et
sudo systemctl status postgresql
sudo systemctl status bulutistan
sudo systemctl status nginx

# Port durumlarÄ±nÄ± kontrol et
sudo netstat -tlnp | grep -E ':(22|80|5432|8000)'
```

### 10.2 Web UygulamasÄ± Testi:
```bash
# Yerel test
curl http://localhost
curl http://127.0.0.1

# IP Ã¼zerinden test
curl http://10.40.39.24

# Admin paneli testi
curl http://10.40.39.24/admin/
```

### 10.3 VeritabanÄ± Testi:
```bash
# Django shell ile test
cd /var/www/bulutistan
source venv/bin/activate
export DJANGO_SETTINGS_MODULE=bulutistan.settings_production
python manage.py shell

# Shell'de test:
from django.db import connection
cursor = connection.cursor()
cursor.execute("SELECT version();")
cursor.fetchone()
exit()
```

## ğŸš¨ ADIM 11: HATA AYIKLAMA

### 11.1 Log DosyalarÄ±nÄ± Kontrol Etme:
```bash
# Django loglarÄ±
tail -f /var/www/bulutistan/logs/django.log

# Gunicorn loglarÄ±
sudo journalctl -u bulutistan -f

# Nginx loglarÄ±
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/nginx/access.log

# PostgreSQL loglarÄ±
sudo tail -f /var/log/postgresql/postgresql-*.log
```

### 11.2 YaygÄ±n Sorunlar ve Ã‡Ã¶zÃ¼mleri:

#### Port 8000 KullanÄ±mda:
```bash
sudo lsof -i :8000
sudo kill -9 <PID>
```

#### Permission HatasÄ±:
```bash
sudo chown -R $USER:$USER /var/www/bulutistan
sudo chmod -R 755 /var/www/bulutistan
```

#### VeritabanÄ± BaÄŸlantÄ± HatasÄ±:
```bash
sudo systemctl status postgresql
sudo -u postgres psql -c "\l"
```

#### Nginx HatasÄ±:
```bash
sudo nginx -t
sudo systemctl restart nginx
```

## ğŸ¯ ADIM 12: OTOMATÄ°K DEPLOYMENT SCRIPT

### 12.1 Deploy Script'ini Ã‡alÄ±ÅŸtÄ±rma:
```bash
# Script'i Ã§alÄ±ÅŸtÄ±rÄ±labilir yap
chmod +x deploy.sh

# Deployment'Ä± baÅŸlat
./deploy.sh
```

### 12.2 Manuel Deployment (Script Ã§alÄ±ÅŸmazsa):
```bash
# YukarÄ±daki tÃ¼m adÄ±mlarÄ± sÄ±rasÄ±yla manuel olarak Ã§alÄ±ÅŸtÄ±r
# Her adÄ±mda sonucu kontrol et
```

## âœ… SON KONTROL LÄ°STESÄ°

### âœ… Sunucu BaÄŸlantÄ±sÄ±:
- [ ] SSH eriÅŸimi saÄŸlandÄ±
- [ ] Ping testi baÅŸarÄ±lÄ±
- [ ] Port 22 aÃ§Ä±k

### âœ… VeritabanÄ±:
- [ ] PostgreSQL kuruldu
- [ ] VeritabanÄ± oluÅŸturuldu
- [ ] KullanÄ±cÄ± oluÅŸturuldu
- [ ] Django migration'larÄ± yapÄ±ldÄ±

### âœ… Django:
- [ ] Python paketleri kuruldu
- [ ] Environment deÄŸiÅŸkenleri ayarlandÄ±
- [ ] Production settings aktif
- [ ] Static dosyalar toplandÄ±
- [ ] Superuser oluÅŸturuldu

### âœ… Web Sunucusu:
- [ ] Gunicorn kuruldu ve Ã§alÄ±ÅŸÄ±yor
- [ ] Systemd service aktif
- [ ] Socket dosyasÄ± oluÅŸtu

### âœ… Reverse Proxy:
- [ ] Nginx kuruldu
- [ ] Site konfigÃ¼rasyonu aktif
- [ ] Proxy ayarlarÄ± doÄŸru

### âœ… GÃ¼venlik:
- [ ] Firewall kurallarÄ± ayarlandÄ±
- [ ] Dosya izinleri doÄŸru
- [ ] SSH gÃ¼venli

### âœ… Test:
- [ ] Ana sayfa aÃ§Ä±lÄ±yor
- [ ] Admin paneli eriÅŸilebilir
- [ ] VeritabanÄ± baÄŸlantÄ±sÄ± Ã§alÄ±ÅŸÄ±yor
- [ ] Log dosyalarÄ± oluÅŸuyor

## ğŸŒ CANLI ORTAM ERÄ°ÅÄ°MÄ°

### Web UygulamasÄ±:
- **URL:** http://10.40.39.24
- **Admin Panel:** http://10.40.39.24/admin/

### Sunucu Bilgileri:
- **IP:** 10.40.39.24
- **Hostname:** ubuntu
- **Ä°ÅŸletim Sistemi:** Ubuntu Linux (64-bit)
- **Django Versiyonu:** 4.2.7
- **VeritabanÄ±:** PostgreSQL
- **Web Sunucusu:** Gunicorn
- **Reverse Proxy:** Nginx

## ğŸ“ DESTEK VE SORUN GÄ°DERME

### Log DosyalarÄ±:
- Django: `/var/www/bulutistan/logs/django.log`
- Gunicorn: `sudo journalctl -u bulutistan -f`
- Nginx: `/var/log/nginx/`
- PostgreSQL: `/var/log/postgresql/`

### Servis YÃ¶netimi:
```bash
# Gunicorn
sudo systemctl start/stop/restart/status bulutistan

# Nginx
sudo systemctl start/stop/restart/status nginx

# PostgreSQL
sudo systemctl start/stop/restart/status postgresql
```

### Performans Ä°zleme:
```bash
# Sistem kaynaklarÄ±
htop
df -h
free -h

# Port durumu
sudo netstat -tlnp

# Servis durumlarÄ±
sudo systemctl list-units --type=service --state=running
```

---

## ğŸ‰ TEBRÄ°KLER! 

Bulutistan Django projesi baÅŸarÄ±yla canlÄ± ortama deploy edildi!

**Sonraki AdÄ±mlar:**
1. SSL sertifikasÄ± ekleyin (Let's Encrypt)
2. Monitoring ve alerting kurun
3. Backup stratejisi oluÅŸturun
4. Performance optimization yapÄ±n
5. Security audit gerÃ§ekleÅŸtirin

**Not:** Bu dokÃ¼manÄ± gÃ¼venli bir yerde saklayÄ±n ve gerektiÄŸinde gÃ¼ncelleyin.
